@if (kontentProduct.value(); as product) {
@if (product === 'n/a') {
<div class="product-unavailable">
    <div class="product-unavailable-icon">ℹ️</div>
    <h3 class="product-unavailable-title">Product Unavailable</h3>
    <p class="product-unavailable-description">
        Product information for this product is currently not available.
    </p>
</div>
} @else {
<div class="product-container">

    @if (product.categories; as categories) {
    <nav class="product-breadcrumbs" aria-label="Breadcrumb">
        <a [routerLink]="'/'" class="breadcrumb-item breadcrumb-link">Home</a>
        <span class="breadcrumb-separator">/</span>
        @for (category of categories; track $index; let isLast = $last) {
        <a [routerLink]="currentCategoryUrl()" class="breadcrumb-item">{{category}}</a>
        @if (!isLast) {
        <span class="breadcrumb-separator">/</span>
        }
        }
    </nav>
    }
    <div [libFlexRow]="true" [libFlexRowAlign]="'start'" [libFlexRowGap]="'24px'">
        <div libFlexColumn [libFlexSize]="'300px'">
            @if (product.image; as image) {
            <img [ngSrc]="image.url" [width]="image.width" [height]="image.height" priority alt="">
            }
        </div>
        <div libFlexColumn libFlexFill>

            <h1>{{product.title}}</h1>
            <div class="product-description" [innerHTML]="product.descriptionHtml"></div>
            <div class="product-price-container">
                @if (commerceToolsProduct.value(); as skuInfo) {
                @if (skuInfo.description) {
                <div class="product-description-section">
                    <div>{{skuInfo.description}}</div>
                </div>
                }
                <div class="price-section">
                    <div class="price-label">Price</div>
                    <div class="price-value">{{skuInfo.price}}</div>
                </div>
                <div class="stock-section">
                    <div class="stock-badge" [class.in-stock]="skuInfo.inStockCount > 0"
                        [class.low-stock]="skuInfo.inStockCount <= 10 && skuInfo.inStockCount > 0"
                        [class.out-of-stock]="skuInfo.inStockCount === 0">
                        <span class="stock-indicator"></span>
                        <span class="stock-text">
                            @if (skuInfo.inStockCount > 10) {
                            In Stock
                            } @else if (skuInfo.inStockCount > 0) {
                            Low Stock ({{skuInfo.inStockCount}} remaining)
                            } @else {
                            Out of Stock
                            }
                        </span>
                    </div>
                </div>
                }
            </div>

            @if (product.bodyBenefits; as bodyBenefits) {
            <div class="product-body-benefits">
                <h3 class="body-benefits-title">Body Benefits</h3>
                <div class="body-benefits-grid">
                    @for (bodyBenefit of bodyBenefits; track bodyBenefit.name) {
                    <div class="product-body-benefit">{{bodyBenefit.icon}} {{bodyBenefit.name}}</div>
                    }
                </div>
            </div>
            }

            @if (product.sections; as sections) {
            @for (section of sections; track section.title) {
            @if (section.html.length > 0) {
            <div class="product-section">
                <h2 class="section-title">{{section.title}}</h2>
                <div class="section-content" [innerHTML]="section.html"></div>
            </div>
            }
            }
            }

            @if (product.recommendedProducts; as recommendedProducts) {
            <div class="product-recommended-products">
                <h3 class="recommended-products-title">Recommended Products</h3>

                @if (recommendedProducts.length === 0) {
                <em class="product-recommended-product-empty">
                    We couldn't find any recommended products for this product at the moment.
                    <br>
                    Please check back later or browse other products.
                </em>
                }

                <div [libFlexRow]="true" [libFlexRowGap]="'24px'" [libFlexRowAlign]="'stretch'">
                    @for (recommendedProduct of recommendedProducts; track recommendedProduct.name) {
                    <div [routerLink]="recommendedProduct.url" class="product-recommended-product" libFlexColumn
                        [libFlexSize]="'200px'">
                        <img [ngSrc]="recommendedProduct.image.url" [width]="recommendedProduct.image.width"
                            [height]="recommendedProduct.image.height" priority alt="">
                        <h4>{{recommendedProduct.name}}</h4>
                    </div>
                    }
                </div>
            </div>
            }
        </div>
    </div>
</div>
}
}